capability_id: pr.threads.composite
version: "1.0.0"
description: "Reply to, resolve, unresolve, or reply-and-resolve multiple PR review threads in a single batched call. Supports mixed actions per thread."
input_schema:
  type: object
  required: [threads]
  properties:
    threads:
      type: array
      minItems: 1
      items:
        type: object
        required: [threadId, action]
        properties:
          threadId:
            type: string
            minLength: 1
          action:
            type: string
            enum: [reply, resolve, reply_and_resolve, unresolve]
          body:
            type: string
            minLength: 1
        additionalProperties: false
  additionalProperties: false
output_schema:
  type: object
  required: [results]
  properties:
    results:
      type: array
      items:
        type: object
        required: [id]
        properties:
          id:
            type: string
          isResolved:
            type: boolean
        additionalProperties: false
  additionalProperties: false
routing:
  preferred: graphql
  fallbacks: []
composite:
  steps:
    - capability_id: pr.thread.reply
      foreach: threads
      actions: [reply, reply_and_resolve]
      params_map:
        threadId: threadId
        body: body
    - capability_id: pr.thread.resolve
      foreach: threads
      actions: [resolve, reply_and_resolve]
      params_map:
        threadId: threadId
    - capability_id: pr.thread.unresolve
      foreach: threads
      actions: [unresolve]
      params_map:
        threadId: threadId
  output_strategy: array
